<!-- Button to add a new crisis plan -->
<ion-item lines="none">
  <ion-button expand="block" color="success" (click)="addPlan()">
    <ion-icon slot="start" name="add"></ion-icon>
    New Crisis Plan
  </ion-button>
</ion-item>

<!-- List of crisis plans -->
<ion-list>
  <ion-item *ngFor="let plan of crisisPlans" lines="none">
    <ion-label class="ion-text-wrap">
      <!-- Plan title -->
      <h2>{{ plan.title }}</h2>

      <!-- ✅ Reorderable steps -->
      <ion-reorder-group
        [disabled]="false"
        (ionItemReorder)="reorderSteps($event, plan)"
      >
        <ion-item *ngFor="let step of plan.steps; let i = index">
          <ion-label>{{ step }}</ion-label>

          <!-- Edit/Delete buttons for each step -->
          <ion-button
            fill="clear"
            size="small"
            color="primary"
            (click)="editStep(plan, i)"
          >
            <ion-icon name="create"></ion-icon>
          </ion-button>
          <ion-button
            fill="clear"
            size="small"
            color="danger"
            (click)="deleteStep(plan, i)"
          >
            <ion-icon name="trash"></ion-icon>
          </ion-button>

          <!-- ✅ Drag handle -->
          <ion-reorder slot="end"></ion-reorder>
        </ion-item>
      </ion-reorder-group>

      <!-- ✅ Plan-level buttons under the step list -->
      <div class="plan-actions">
        <ion-button fill="outline" color="primary" (click)="editPlan(plan)">
          <ion-icon slot="start" name="create"></ion-icon>
          Edit Plan
        </ion-button>
        <ion-button fill="outline" color="danger" (click)="deletePlan(plan)">
          <ion-icon slot="start" name="trash"></ion-icon>
          Delete Plan
        </ion-button>
        <ion-button color="success" (click)="addStep(plan)">
          <ion-icon slot="start" name="add"></ion-icon>
          Add Step
        </ion-button>
      </div>
    </ion-label>
  </ion-item>
</ion-list>